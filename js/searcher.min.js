const search=function(){const e=document.getElementById("searcher"),t=document.getElementById("finder"),n=document.getElementById("search-message"),i=document.getElementById("close-finder"),l=document.getElementById("finder-output"),s=document.getElementById("curtain"),o=document.createElement("span");n.append(o);let d=document.querySelectorAll("a");const a=[];for(let e of d){if("hidden"===e.id)continue;let t=e.getAttribute("data-tags");a.push({web:e.href.replace("https://",""),title:e.title,tags:t||"",elem:e})}const c=[],r=(e,t)=>c.push(setTimeout((()=>{e()}),t)),h=t=>{"Escape"==t.key&&(y(),p(),e.blur())},y=()=>{(t.style.display="block")&&(c.forEach((e=>clearTimeout(e))),t.style.opacity=0,r((()=>t.style.display="none"),350),document.removeEventListener("keydown",h))},u=()=>{s.style.opacity=.7,s.style.width="100%",s.style.height="100%"},p=()=>{s.style.opacity=0,s.style.width="0px",s.style.height="0px"},g=(e,t)=>{switch(e){case"start":o.innerHTML="enter at least 3 letters";break;case"found":o.innerHTML="found "+t+(t>1?" sites":" site");break;case"no found":o.innerHTML="nothing was found"}lastMessageType=e};let m=[],f=[];{setTimeout((()=>{e.value=""}),50),t.style.display="none",t.style.opacity=0,t.style.transition="all .30s";const n=()=>{y(),p()};r((()=>{s.style.transition="opacity .30s",s.addEventListener("click",n)}),350),i.addEventListener("click",n)}return{onkeypress:e=>{let n=e.target.value.toLowerCase();if(m.forEach((e=>e.remove())),m=[],f=[],t.style.width="",t.style.maxHeight="400px",l.style.maxHeight="370px",n.length<3)return g("start"),void p();for(let e of a)(e.web.indexOf(n)>-1||e.title.indexOf(n)>-1||e.tags.indexOf(n)>-1)&&f.push(e);if(f.length>0?g("found",f.length):g("no found"),u(),f.forEach((e=>{let t=e.elem.cloneNode(!0);l.append(t),m.push(t),0===t.children.length&&(t.style.width="max-content")})),m.length>0){let e=m[0].getBoundingClientRect(),n=null;const i=()=>{let t={x:0,width:0};return m.forEach((e=>{let i=e.getBoundingClientRect();i.x>=t.x&&(i.x>t.x&&(t.width=0),i.width>t.width&&(t.x=i.x,t.width=i.width,n=e))})),t.x+t.width-e.x+24};let s=i(),o=0;if(s+400>window.innerWidth)do{s=window.innerWidth-300,t.style.maxHeight=400+o+"px",l.style.maxHeight=370+o+"px",o+=120,s=i()}while(s+400>window.innerWidth);t.style.width=s+"px"}},onfocus:()=>{g("start"),(t.style.display="none")&&(c.forEach((e=>clearTimeout(e))),t.style.display="block",r((()=>t.style.opacity=1),50),document.addEventListener("keydown",h)),f.length>0&&u()},onfocusout:()=>{0==f.length&&(y(),p())}}}();
